{"version":3,"file":"systemjs-bundle.js","sourceRoot":"./src/","sources":["lib.ts","index.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Constants\n */\nconst bodyDatasetName = \"tsslock\";\nconst elementDatasetName = \"tsslockid\";\nconst styleBackupDatasetName = \"tsslockstyle\";\n\nconst lockStyle = \";overscroll-behavior:none!important;-webkit-overflow-scrolling: auto!important;overflow:hidden!important;\";\n\n// used to fix iOS body scrolling when content is not large enough to be scrolled but has overflow-y: scroll\nconst scrollYContentLockStyle = \";overflow-y:unset!important;\";\n\n/**\n * Lock Handler\n */\nexport const removeAllScrollLocks = (observer: ResizeObserver | null) => {\n  getAllLockedElements().forEach((element) => {\n    if (!(element instanceof HTMLElement)) {\n      console.warn(\n        \"removing scroll lock for Elment\",\n        element,\n        \"is not possible, as it is not a HTMLElement\"\n      );\n      return;\n    }\n    removeScrollLock(element, observer);\n  });\n  unlockBodyScroll();\n};\n\nexport const removeScrollLock = (element: HTMLElement, observer: ResizeObserver | null) => {\n  unregisterLockIdOnBody(element);\n  unlockScrollElement(element);\n  if (observer) {\n    observer.disconnect();\n  }\n\n  if (!hasActiveScrollLocks()) {\n    unlockBodyScroll();\n  }\n};\n\nexport const lockBodyScroll = () => {\n  const html = getHtml();\n  const body = getBody();\n\n  addStyleOverride(html, lockStyle);\n  addStyleOverride(body, lockStyle);\n};\n\nexport const getLockContentScrollResizeObserver = (): ResizeObserver | null => {\n  if (!document) {\n    return null;\n  }\n  return new ResizeObserver((entries) => {\n    if (entries) {\n      const scrollContentElement = entries[0]?.target.parentElement;\n      if (scrollContentElement && scrollContentElement.parentElement) {\n        unlockScrollElement(scrollContentElement);\n        lockContentScrollElement(scrollContentElement.parentElement, scrollContentElement)\n      }\n    }\n  });\n}\n\n// used to fix iOS body scrolling when content is not large enough to be scrolled but has overflow-y: scroll\nexport const lockContentScrollElement = (\n  containerElement: HTMLElement,\n  scrollContentElement: HTMLElement\n) => {\n  const containerHeight = containerElement.getBoundingClientRect().height;\n  const contentHeight = scrollContentElement.getBoundingClientRect().height;\n  // also get children height as contentHeight might be set to 100% and is scrollable\n  const contentChildrenHeight = getChildNodesHeight(\n    scrollContentElement.children\n  );\n\n  // only lock element if wrapper or children are larger\n  if (\n    containerHeight >= contentHeight &&\n    containerHeight >= contentChildrenHeight\n  ) {\n    lockScrollElement(scrollContentElement);\n  }\n};\n\nconst unlockBodyScroll = () => {\n  const html = getHtml();\n  const body = getBody();\n\n  removeStyleOverride(html);\n  removeStyleOverride(body);\n};\n\nconst lockScrollElement = (element: HTMLElement) => {\n  addStyleOverride(element, scrollYContentLockStyle);\n\n  if (isIOS) {\n    element.addEventListener(\"touchmove\", preventTouchmoveHandler);\n  }\n};\n\nconst unlockScrollElement = (element: HTMLElement) => {\n  removeStyleOverride(element);\n  unregisterLockIdOnElement(element);\n\n  if (isIOS) {\n    element.removeEventListener(\"touchmove\", preventTouchmoveHandler);\n  }\n};\n\n/**\n * Inline Style handler\n */\nconst addStyleOverride = (element: HTMLElement, styleOverride: string) => {\n  if (element.dataset[styleBackupDatasetName]) {\n    // style is already applied\n    return;\n  }\n  // set some style as default\n  element.dataset[styleBackupDatasetName] = '';\n\n  const currentStyle = element.getAttribute(\"style\");\n  if (currentStyle === null) {\n    return element.setAttribute(\"style\", styleOverride);\n  }\n  if (currentStyle.length > 0) {\n    // store current inline style\n    element.dataset[styleBackupDatasetName] = currentStyle;\n  }\n  return element.setAttribute(\"style\", `${currentStyle}${styleOverride}`);\n};\n\nconst removeStyleOverride = (element: HTMLElement) => {\n  const currentStyle = element.getAttribute(\"style\");\n  if (currentStyle == null) {\n    return;\n  }\n  const storedStyle = element.dataset[styleBackupDatasetName];\n  element.removeAttribute(\"data-\".concat(styleBackupDatasetName))\n\n  if (!storedStyle) {\n    return element.removeAttribute(\"style\");\n  }\n  return element.setAttribute(\"style\", storedStyle);\n};\n\n/**\n * Body Lock Id handling\n */\nexport const registerLockIdOnBody = (id: string) => {\n  const body = getBody();\n  if (!body.dataset[bodyDatasetName]) {\n    body.dataset[bodyDatasetName] = id;\n    return;\n  }\n  if (body.dataset[bodyDatasetName].indexOf(id) > -1) {\n    return;\n  }\n  body.dataset[bodyDatasetName] += `,${id}`;\n};\n\nconst unregisterLockIdOnBody = (element: HTMLElement) => {\n  const body = getBody();\n  if (!body.dataset[bodyDatasetName]) {\n    return;\n  }\n  if (body.dataset[bodyDatasetName].indexOf(\",\") === -1) {\n    body.removeAttribute(`data-${bodyDatasetName}`);\n    return;\n  }\n  const id = getElementLockId(element);\n  body.dataset[bodyDatasetName] = body.dataset[bodyDatasetName].replace(\n    `,${id}`,\n    \"\"\n  );\n\n  return;\n};\n\n/**\n * Element Lock Id handling\n */\nexport const registerLockIdOnElement = (element: HTMLElement, id: string) => {\n  return (element.dataset[elementDatasetName] = id);\n};\n\nconst getElementLockId = (element: HTMLElement) => {\n  return element.dataset[elementDatasetName];\n};\n\nconst getAllLockedElements = () =>\n  document.querySelectorAll(`[data-${elementDatasetName}]`);\n\nconst hasActiveScrollLocks = () => {\n  return getAllLockedElements().length > 0;\n};\n\nconst unregisterLockIdOnElement = (element: HTMLElement) => {\n  return element.removeAttribute(`data-${elementDatasetName}`);\n};\n\n/**\n * DOM Helper\n */\nconst getBody = () => {\n  return getElement('body');\n};\n\nconst getHtml = () => {\n  return getElement('html');\n}\n\nconst getElement = (selector: string): HTMLElement => {\n  const element = document.querySelector(selector);\n  if (!(element instanceof HTMLElement)) {\n    throw `could not locate ${selector} in DOM`\n  }\n  return element;\n}\n\nconst preventTouchmoveHandler = (e: TouchEvent) => {\n  try {\n    e.preventDefault();\n  } catch (e) {}\n};\n\nconst getChildNodesHeight = (children: HTMLCollection) => {\n  let height = 0;\n\n  for (const child of <any>children) {\n    height = height + child.getBoundingClientRect().height;\n  }\n\n  return height;\n};\n\nconst isIOS =\n  typeof window !== \"undefined\" && // prevent SSR context\n  ((navigator.userAgent.indexOf(\"Mac\") > -1 && \"ontouchend\" in document) ||\n    (() => {\n      let isIOSDevice = false;\n      [\"iPad\", \"iPhone\", \"iPod\"].forEach((device: string) => {\n        if (navigator.platform.indexOf(device) > -1) {\n          isIOSDevice = true;\n        }\n      });\n      return isIOSDevice;\n    })());\n","import {\n  registerLockIdOnBody,\n  registerLockIdOnElement,\n  lockBodyScroll,\n  removeAllScrollLocks,\n  lockContentScrollElement,\n  removeScrollLock, getLockContentScrollResizeObserver,\n} from \"./lib\";\n\nexport {\n  removeScrollLock,\n  useBodyScrollLock,\n  lockBodyScroll,\n  removeAllScrollLocks,\n};\n\nexport default function useBodyScrollLock(\n  id: string,\n  containerElement: HTMLElement,\n  scrollContentElement?: HTMLElement\n) {\n  registerLockIdOnBody(id);\n  registerLockIdOnElement(containerElement, id);\n  lockBodyScroll();\n\n  const observer = getLockContentScrollResizeObserver()\n  if (scrollContentElement && observer) {\n    lockContentScrollElement(containerElement, scrollContentElement);\n    Array.from(scrollContentElement.children).forEach((child: Element) => {\n      observer.observe(child)\n    })\n  }\n\n  return {\n    removeScrollLock: () => removeScrollLock(containerElement, observer),\n    removeAllScrollLocks: () => removeAllScrollLocks(observer),\n  };\n}\n"]}